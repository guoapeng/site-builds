<p>Angulartics2 是一个用于 Angular 应用程序的分析工具。它可以自动跟踪导航事件并将其发送到您的分析服务提供程序，例如百度统计, Google Analytics 等。您可以通过运行<code>npm i angulartics2</code>在项目中开始使用 angulartics。</p>
<!-- more -->


        <h2 id="1--%E8%8E%B7%E5%8F%96%E7%99%BE%E5%BA%A6%E7%BB%9F%E8%AE%A1%E8%B4%A6%E5%8F%B7" class="docs-header-link">
          <span header-link="1--%E8%8E%B7%E5%8F%96%E7%99%BE%E5%BA%A6%E7%BB%9F%E8%AE%A1%E8%B4%A6%E5%8F%B7"></span>
          1. 获取百度统计账号
        </h2>
      <p>关于如何获取百度统计账号, 可以访问我以前的博客<a target="_blank" href="https://www.pengtech.net/product/baidu_analytics.html">百度统计的使用</a></p>

        <h2 id="2--%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE-angulartics2" class="docs-header-link">
          <span header-link="2--%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE-angulartics2"></span>
          2. 安装与配置 angulartics2
        </h2>
      <p>在命令行中运行<code>npm i angulartics2</code>以安装 angulartics2.</p>

        <h3 id="2-1--%E9%85%8D%E7%BD%AE-angulartics2" class="docs-header-link">
          <span header-link="2-1--%E9%85%8D%E7%BD%AE-angulartics2"></span>
          2.1. 配置 angulartics2
        </h3>
      <ol>
<li>将 angulartics2 添加到项目的根模块(root module)</li>
</ol>
<pre class="language-ts"><code class="language-ts"><div>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NgModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/platform-browser'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> RouterModule<span class="token punctuation">,</span> Routes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/router'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Angulartics2Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'angulartics2'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Angulartics2GoogleAnalytics <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'angulartics2'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ROUTES<span class="token punctuation">:</span> Routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> path<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>      component<span class="token punctuation">:</span> HomeComponent <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> path<span class="token punctuation">:</span> <span class="token string">'about'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> AboutComponent <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    BrowserModule<span class="token punctuation">,</span>
    RouterModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span>ROUTES<span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token comment" spellcheck="true">// added to imports</span>
    Angulartics2Module<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// 添加Angulartics2Module 模块</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  declarations<span class="token punctuation">:</span> <span class="token punctuation">[</span>AppComponent<span class="token punctuation">]</span><span class="token punctuation">,</span>
  bootstrap<span class="token punctuation">:</span> <span class="token punctuation">[</span>AppComponent<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</div></code></pre>
<blockquote>
<p>注意: 如果是使用<a target="_blank" href="https://angular.io/guide/standalone-components">Standalone component</a>引导启动的 Angular 应用, 需要在
ApplicationConfig 配置中引入 Angulartics2Module</p>
<pre class="language-ts"><code class="language-ts"><div><span class="token function">importProvidersFrom</span><span class="token punctuation">(</span>Angulartics2Module<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></div></code></pre>
</blockquote>
<ol start="2">
<li><p>在项目的根组件(root component)中引入相应的分析服务 provider, 例如 Angulartics2BaiduAnalytics
并调用tracking</p>
<pre class="language-typescript"><code class="language-typescript"><div> <span class="token comment" spellcheck="true">// in root component</span>
 <span class="token keyword">import</span> <span class="token punctuation">{</span> Angulartics2BaiduAnalytics <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'angulartics2'</span><span class="token punctuation">;</span>

 @<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  <span class="token operator">...</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppComponent</span> <span class="token punctuation">{</span>
   <span class="token keyword">constructor</span><span class="token punctuation">(</span>angulartics2BaiduAnalytics<span class="token punctuation">:</span> Angulartics2BaiduAnalytics<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     angulartics2BaiduAnalytics<span class="token punctuation">.</span><span class="token function">startTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span></div></code></pre>
</li>
</ol>

        <h2 id="3--%E4%BD%BF%E7%94%A8-angulartics2" class="docs-header-link">
          <span header-link="3--%E4%BD%BF%E7%94%A8-angulartics2"></span>
          3. 使用 angulartics2
        </h2>
      <p>前面两部导入Angulartics2Module 和 startTracking 是必要的两步. 完成以上操作后, 我们就可以开始使用angulartics2BaiduAnalytics.</p>

        <h3 id="3-1--%E8%B7%9F%E8%B8%AA%E6%A8%A1%E6%9D%BF/html%E4%B8%AD%E7%9A%84%E4%BA%8B%E4%BB%B6" class="docs-header-link">
          <span header-link="3-1--%E8%B7%9F%E8%B8%AA%E6%A8%A1%E6%9D%BF/html%E4%B8%AD%E7%9A%84%E4%BA%8B%E4%BB%B6"></span>
          3.1. 跟踪模板/HTML中的事件
        </h3>
      <p>要跟踪事件，您可以将指令angulartics2On注入任何组件，并使用属性angulartics3On、angularticsAction和angularticsCategory：</p>
<pre class="language-ts"><code class="language-ts"><div><span class="token comment" spellcheck="true">// component</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token punctuation">:</span> <span class="token string">'song-download-box'</span><span class="token punctuation">,</span>
  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`
    &lt;div 
      angulartics2On="click" 
      angularticsAction="DownloadClick" 
      [angularticsCategory]="song.name">
      Click Me
    &lt;/div>
  `</span></span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">SongDownloadBox</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> NgModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Angulartics2Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'angulartics2'</span><span class="token punctuation">;</span>

@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    Angulartics2Module<span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  declarations<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    SongDownloadBox<span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</div></code></pre>
<p>如果需要事件标签，可以使用</p>
<pre class="language-ts"><code class="language-ts"><div>
<span class="token operator">&lt;</span>div 
  angulartics2On<span class="token operator">=</span><span class="token string">"click"</span> 
  angularticsAction<span class="token operator">=</span><span class="token string">"DownloadClick"</span> 
  angularticsLabel<span class="token operator">=</span><span class="token string">"label-name"</span> 
  angularticsValue<span class="token operator">=</span><span class="token string">"value"</span> 
  <span class="token punctuation">[</span>angularticsCategory<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"song.name"</span> 
  <span class="token punctuation">[</span>angularticsProperties<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"{'custom-property': 'Fall Campaign'}"</span><span class="token operator">></span>
  Click Me
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
</div></code></pre>

        <h3 id="3-2--%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%A0%81%E8%B7%9F%E8%B8%AA%E4%BA%8B%E4%BB%B6" class="docs-header-link">
          <span header-link="3-2--%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%A0%81%E8%B7%9F%E8%B8%AA%E4%BA%8B%E4%BB%B6"></span>
          3.2. 使用代码跟踪事件
        </h3>
      <pre class="language-ts"><code class="language-ts"><div><span class="token keyword">import</span> <span class="token punctuation">{</span> Angulartics2 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'angulartics2'</span><span class="token punctuation">;</span>

<span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> angulartics2<span class="token punctuation">:</span> Angulartics2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>angulartics2<span class="token punctuation">.</span>eventTrack<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
    action<span class="token punctuation">:</span> <span class="token string">'myAction'</span><span class="token punctuation">,</span> 
    properties<span class="token punctuation">:</span> <span class="token punctuation">{</span> category<span class="token punctuation">:</span> <span class="token string">'myCategory'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</div></code></pre>
<p>如果需要事件标签，可以使用</p>
<pre class="language-ts"><code class="language-ts"><div>
<span class="token keyword">this</span><span class="token punctuation">.</span>angulartics2<span class="token punctuation">.</span>eventTrack<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
  action<span class="token punctuation">:</span> <span class="token string">'myAction'</span><span class="token punctuation">,</span>
  properties<span class="token punctuation">:</span> <span class="token punctuation">{</span> 
    category<span class="token punctuation">:</span> <span class="token string">'myCategory'</span><span class="token punctuation">,</span> 
    label<span class="token punctuation">:</span> <span class="token string">'myLabel'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</div></code></pre>

        <h2 id="4--angulartics2-%E9%AB%98%E7%BA%A7%E9%85%8D%E7%BD%AE" class="docs-header-link">
          <span header-link="4--angulartics2-%E9%AB%98%E7%BA%A7%E9%85%8D%E7%BD%AE"></span>
          4. Angulartics2 高级配置
        </h2>
      
        <h3 id="4-1--%E6%8E%92%E9%99%A4%E8%B7%9F%E8%B8%AA%E4%B8%80%E4%BA%9B%E9%A1%B5%E9%9D%A2" class="docs-header-link">
          <span header-link="4-1--%E6%8E%92%E9%99%A4%E8%B7%9F%E8%B8%AA%E4%B8%80%E4%BA%9B%E9%A1%B5%E9%9D%A2"></span>
          4.1. 排除跟踪一些页面
        </h3>
      <p>传递字符串文字或正则表达式以从自动页面跟踪中排除一些页面。</p>
<pre class="language-ts"><code class="language-ts"><div>
Angulartics2Module<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  pageTracking<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    excludedRoutes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token regex">/\/[0-9]{4}\/[0-9]{2}\/[a-zA-Z0-9|\-]*/</span><span class="token punctuation">,</span>
      <span class="token string">'2017/03/article-title'</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</div></code></pre>

        <h3 id="4-2--%E4%BB%8Eurl%E8%B7%AF%E5%BE%84%E4%B8%AD%E5%88%A0%E9%99%A4id" class="docs-header-link">
          <span header-link="4-2--%E4%BB%8Eurl%E8%B7%AF%E5%BE%84%E4%B8%AD%E5%88%A0%E9%99%A4id"></span>
          4.2. 从url路径中删除ID
        </h3>
      <p>有时如果统计完整的url路径, 在统计报告中看起来非常琐碎, 所以需要去除一些信息, 例如id, 我们可以像下面这样去配置.</p>
<pre class="language-ts"><code class="language-ts"><div>Angulartics2Module<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  pageTracking<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    clearIds<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></div></code></pre>
<p>默认情况下，它会删除与此模式匹配的ID（即，所有数字或UUID）：<code>^\d+$|^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$</code>.</p>
<p>如果需要，您可以设置自己的regexp：</p>
<p>例如使得/project/a01/feature变成/project/feature</p>
<pre class="language-ts"><code class="language-ts"><div>Angulartics2Module<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  pageTracking<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    clearIds<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>
    idsRegExp<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'^[a-z]\\d+$'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">/* Workaround: No NgModule metadata found for 'AppModule' */</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</div></code></pre>

        <h3 id="4-3--%E4%BB%8Eurl%E8%B7%AF%E5%BE%84%E4%B8%AD%E5%88%A0%E9%99%A4%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0" class="docs-header-link">
          <span header-link="4-3--%E4%BB%8Eurl%E8%B7%AF%E5%BE%84%E4%B8%AD%E5%88%A0%E9%99%A4%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0"></span>
          4.3. 从url路径中删除查询参数
        </h3>
      <p>这可以与clearId和idsRegExp组合使用</p>
<p>/project/12981/feature?param=12变为/project/12981/feature</p>
<pre class="language-ts"><code class="language-ts"><div>
Angulartics2Module<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  pageTracking<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    clearQueryParams<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</div></code></pre>

        <h3 id="4-4--%E4%BB%8Eurl%E8%B7%AF%E5%BE%84%E4%B8%AD%E5%88%A0%E9%99%A4hash" class="docs-header-link">
          <span header-link="4-4--%E4%BB%8Eurl%E8%B7%AF%E5%BE%84%E4%B8%AD%E5%88%A0%E9%99%A4hash"></span>
          4.4. 从url路径中删除hash
        </h3>
      <p>/callback#authcode=123&amp;idToken=456 变成 /callback</p>
<pre class="language-ts"><code class="language-ts"><div>Angulartics2Module<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  pageTracking<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    clearHash<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></div></code></pre>

        <h3 id="4-5--%E5%9C%A8%E6%B2%A1%E6%9C%89%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B%E4%BD%BF%E7%94%A8" class="docs-header-link">
          <span header-link="4-5--%E5%9C%A8%E6%B2%A1%E6%9C%89%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B%E4%BD%BF%E7%94%A8"></span>
          4.5. 在没有路由器的情况下使用
        </h3>
      <p>警告：此支持仍然是实验性的</p>
<p>@仍必须安装angular/router！但是，它不会被使用。</p>
<pre class="language-ts"><code class="language-ts"><div>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Angulartics2RouterlessModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'angulartics2'</span><span class="token punctuation">;</span>
@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// ...</span>
  imports<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    BrowserModule<span class="token punctuation">,</span>
    Angulartics2RouterlessModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</div></code></pre>

        <h3 id="4-6--%E4%B8%8Eui%E8%B7%AF%E7%94%B1%E5%99%A8%E4%B8%80%E8%B5%B7%E4%BD%BF%E7%94%A8" class="docs-header-link">
          <span header-link="4-6--%E4%B8%8Eui%E8%B7%AF%E7%94%B1%E5%99%A8%E4%B8%80%E8%B5%B7%E4%BD%BF%E7%94%A8"></span>
          4.6. 与UI路由器一起使用
        </h3>
      <p>警告：此支持仍然是实验性的</p>
<p>@仍必须安装angular/router！但是，它不会被使用。</p>
<pre class="language-ts"><code class="language-ts"><div><span class="token keyword">import</span> <span class="token punctuation">{</span> Angulartics2UirouterModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'angulartics2'</span><span class="token punctuation">;</span>
@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// ...</span>
  imports<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    BrowserModule<span class="token punctuation">,</span>
    Angulartics2UirouterModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></div></code></pre>

        <h2 id="5--trouble-shooting" class="docs-header-link">
          <span header-link="5--trouble-shooting"></span>
          5. trouble shooting
        </h2>
      <ol>
<li>问题一, 当运行server sider rendering 时, 报错ReferenceError: _hmt is not defined</li>
</ol>
<pre class="language-bash"><code class="language-bash"><div>
 Build at: 2023-11-16T08:00:28.460Z - Hash: b945708904bd624f - Time: 78602ms
⠙ Prerendering 13 route<span class="token punctuation">(</span>s<span class="token punctuation">)</span> to D:\dev\proj\demo-angular-project\dist\demo-angular-web\browser<span class="token punctuation">..</span>.ReferenceError: _hmt is not defined
    at new Angulartics2BaiduAnalytics <span class="token punctuation">(</span>D:\dev\proj\demo-angular-project\dist\demo-angular-web\server\main.js:199481:12<span class="token punctuation">)</span>
    at Object.Angulartics2BaiduAnalytics_Factory <span class="token punctuation">[</span>as factory<span class="token punctuation">]</span> <span class="token punctuation">(</span>D:\dev\proj\demo-angular-project\dist\demo-angular-web\server\main.js:199536:10<span class="token punctuation">)</span>
    at D:\dev\proj\demo-angular-project\dist\demo-angular-web\server\main.js:134269:33
    at runInInjectorProfilerContext <span class="token punctuation">(</span>D:\dev\proj\demo-angular-project\dist\demo-angular-web\server\main.js:125777:5<span class="token punctuation">)</span>
    at R3Injector.hydrate <span class="token punctuation">(</span>D:\dev\proj\demo-angular-project\dist\demo-angular-web\server\main.js:134268:9<span class="token punctuation">)</span>
    at R3Injector.get <span class="token punctuation">(</span>D:\dev\proj\demo-angular-project\dist\demo-angular-web\server\main.js:134148:23<span class="token punctuation">)</span>
    at R3Injector.get <span class="token punctuation">(</span>D:\dev\proj\demo-angular-project\dist\demo-angular-web\server\main.js:134157:27<span class="token punctuation">)</span>
    at ChainedInjector.get <span class="token punctuation">(</span>D:\dev\proj\demo-angular-project\dist\demo-angular-web\server\main.js:138783:32<span class="token punctuation">)</span>
    at lookupTokenUsingModuleInjector <span class="token punctuation">(</span>D:\dev\proj\demo-angular-project\dist\demo-angular-web\server\main.js:129505:31<span class="token punctuation">)</span>
    at getOrCreateInjectable <span class="token punctuation">(</span>D:\dev\proj\demo-angular-project\dist\demo-angular-web\server\main.js:129551:10<span class="token punctuation">)</span>
✖ Prerendering routes to D:\dev\proj\demo-angular-project\dist\demo-angular-web\browser failed.
_hmt is not defined
</div></code></pre>
<p>问题原因: 因为时server side 而不是浏览器中运行angulartics2, 所以找不到_hmt</p>
<p>解决办法:</p>
<ol>
<li><p>我已经提交<a target="_blank" href="https://github.com/angulartics/angulartics2/issues/476">issue</a>给angulartics2, 正在等待它们回复.</p>
</li>
<li><p>这里有一个<a target="_blank" href="https://stackoverflow.com/questions/60667522/is-it-possible-to-avoid-page-tracking-root-route-to-ga-by-angulartics2">类似的问题</a>, 里面提到了一种workaround, 即通过服务去访问angulartics2, 定义一个专门针对server side的service, 在服务中避免调用angulartics2</p>
</li>
</ol>

        <h2 id="6--%E7%9B%B8%E5%85%B3%E6%96%87%E7%AB%A0" class="docs-header-link">
          <span header-link="6--%E7%9B%B8%E5%85%B3%E6%96%87%E7%AB%A0"></span>
          6. 相关文章
        </h2>
      <p>最新更新以及更多 Angular 相关文章请访问 <a target="_blank" href="https://www.pengtech.net/angular/">Angular 专题 | 鹏叔的技术博客</a></p>

        <h2 id="7--%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3" class="docs-header-link">
          <span header-link="7--%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"></span>
          7. 参考文档
        </h2>
      <div class="dg-paragraph"><a target="_blank" href="https://github.com/angulartics/angulartics2">angulartics2</a></div>
